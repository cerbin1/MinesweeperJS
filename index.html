<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>Minesweeper</title>
    <link rel="stylesheet" href="style.css">
</head>
<body onload="plantBombs()">
<table>
    <tr>
        <td onclick="playerMove(this)" id="0"></td>
        <td onclick="playerMove(this)" id="1"></td>
        <td onclick="playerMove(this)" id="2"></td>
        <td onclick="playerMove(this)" id="3"></td>
        <td onclick="playerMove(this)" id="4"></td>
    </tr>
    <tr>
        <td onclick="playerMove(this)" id="5"></td>
        <td onclick="playerMove(this)" id="6"></td>
        <td onclick="playerMove(this)" id="7"></td>
        <td onclick="playerMove(this)" id="8"></td>
        <td onclick="playerMove(this)" id="9"></td>
    </tr>
    <tr>
        <td onclick="playerMove(this)" id="10"></td>
        <td onclick="playerMove(this)" id="11"></td>
        <td onclick="playerMove(this)" id="12"></td>
        <td onclick="playerMove(this)" id="13"></td>
        <td onclick="playerMove(this)" id="14"></td>
    </tr>
    <tr>
        <td onclick="playerMove(this)" id="15"></td>
        <td onclick="playerMove(this)" id="16"></td>
        <td onclick="playerMove(this)" id="17"></td>
        <td onclick="playerMove(this)" id="18"></td>
        <td onclick="playerMove(this)" id="19"></td>
    </tr>
    <tr>
        <td onclick="playerMove(this)" id="20"></td>
        <td onclick="playerMove(this)" id="21"></td>
        <td onclick="playerMove(this)" id="22"></td>
        <td onclick="playerMove(this)" id="23"></td>
        <td onclick="playerMove(this)" id="24"></td>
    </tr>
</table>

<div id="remainingBombs"></div>

<script>
    var board = [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false];
    var isFieldClicked = [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false];
    var emptyFields = [false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false, false];
    var howManyBombsNear = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];
    var numberOfBombs = 5;
    var remainingBombs = board.length - numberOfBombs;
    var numberOfBombsToDisplay;

    function plantBombs() {
        for (var i = 0; i < numberOfBombs; i++) {
            while (true) {
                var randomNumber = Math.floor(Math.random() * board.length);
                if (!board[randomNumber]) {
                    board[randomNumber] = true;
                    console.log(randomNumber);
                    break;
                }
            }

        }
    }

    function playerMove(object) {
        numberOfBombsToDisplay = 0;
        if (!isFieldClicked[object.id]) {


            if (board[object.id]) {
                console.log("trafiles na bombe");
                displayAllBombs();
            }
            else if (object.id == 0) {
                console.log("Uff, to nie bomba");
                if (board[1]) {
                    numberOfBombsToDisplay++;
                    howManyBombsNear[1]++;
                }
                if (board[5]) {
                    numberOfBombsToDisplay++;
                    howManyBombsNear[5]++;
                }
                if (board[6]) {
                    numberOfBombsToDisplay++;
                    howManyBombsNear[6]++;
                }
                displayNumberOfBombsNear(numberOfBombsToDisplay, object.id);
                remainingBombs--;
                displayRemainingBombs();
            }
            else if (object.id == 4) {
                console.log("Uff, to nie bomba");
                if (board[3]) {
                    numberOfBombsToDisplay++;
                    howManyBombsNear[3]++;
                }
                if (board[8]) {
                    numberOfBombsToDisplay++;
                    howManyBombsNear[8]++;
                }
                if (board[9]) {
                    numberOfBombsToDisplay++;
                    howManyBombsNear[9]++;
                }
                displayNumberOfBombsNear(numberOfBombsToDisplay, object.id);
                remainingBombs--;
                displayRemainingBombs();
            }
            else if (object.id == 20) {
                console.log("Uff, to nie bomba");
                if (board[15]) {
                    numberOfBombsToDisplay++;
                    howManyBombsNear[15]++;
                }
                if (board[16]) {
                    numberOfBombsToDisplay++;
                    howManyBombsNear[16]++;
                }
                if (board[21]) {
                    numberOfBombsToDisplay++;
                    howManyBombsNear[21]++;
                }
                displayNumberOfBombsNear(numberOfBombsToDisplay, object.id);
                remainingBombs--;
                displayRemainingBombs();
            }
            else if (object.id == 24) {
                console.log("Uff, to nie bomba");
                if (board[18]) {
                    numberOfBombsToDisplay++;
                    howManyBombsNear[18]++;
                }
                if (board[19]) {
                    numberOfBombsToDisplay++;
                    howManyBombsNear[19]++;
                }
                if (board[23]) {
                    numberOfBombsToDisplay++;
                    howManyBombsNear[23]++;
                }
                displayNumberOfBombsNear(numberOfBombsToDisplay, object.id);
                remainingBombs--;
                displayRemainingBombs();
            }
            else if (object.id == 1 || object.id == 2 || object.id == 3) {
                upperEdge(object.id);
            }
            else if (object.id == 6 || object.id == 7 || object.id == 8 || object.id == 11 || object.id == 12 || object.id == 13 || object.id == 16 || object.id == 17 || object.id == 18) {
                mid(object.id);
            }
            else if (object.id == 5 || object.id == 10 || object.id == 15) {
                leftEdge(object.id);
            }
            else if (object.id == 9 || object.id == 14 || object.id == 19) {
                rightEdge(object.id);
            }
            else if (object.id == 21 || object.id == 22 || object.id == 23) {
                lowerEdge(object.id);
            }
            else
                console.log(object.id);
        }
    }

    function upperEdge(index) {
        if (board[parseInt(index) - 1]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[parseInt(index) - 1]++;
            console.log("bomby " + numberOfBombsToDisplay);
        }
        if (board[parseInt(index) + 1]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[parseInt(index) + 1]++;
            console.log("bomby " + numberOfBombsToDisplay);
        }
        if (board[parseInt(index) + 4]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[parseInt(index) + 4]++;
            console.log("bomby " + numberOfBombsToDisplay);
        }
        if (board[parseInt(index) + 5]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[parseInt(index) + 5]++;
            console.log("bomby " + numberOfBombsToDisplay);
        }
        if (board[parseInt(index) + 6]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[parseInt(index) + 6]++;
            console.log("bomby " + numberOfBombsToDisplay);
        }
        displayNumberOfBombsNear(numberOfBombsToDisplay, index);
        remainingBombs--;
        displayRemainingBombs();
    }

    function mid(index) {
        if (board[parseInt(index) - 6]) {
            console.log(index - 6);
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        if (board[parseInt(index) - 5]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
            console.log(index - 5);
        }
        if (board[parseInt(index) - 4]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
            console.log(index - 4);
        }
        if (board[parseInt(index) - 1]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
            console.log(index - 1);
        }
        if (board[parseInt(index) + 1]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
            console.log(index + 1);
        }
        if (board[parseInt(index) + 4]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
            console.log(index + 4);
        }
        if (board[parseInt(index) + 5]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
            console.log(index + 5);
        }
        if (board[parseInt(index) + 6]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
            console.log(index + 6);
        }
        displayNumberOfBombsNear(numberOfBombsToDisplay, index);
        remainingBombs--;
        displayRemainingBombs();
    }

    function leftEdge(index) {
        if (board[parseInt(index) - 5]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        if (board[parseInt(index) - 4]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        if (board[parseInt(index) + 1]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        if (board[parseInt(index) + 5]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        if (board[parseInt(index) + 6]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        displayNumberOfBombsNear(numberOfBombsToDisplay, index);
        remainingBombs--;
        displayRemainingBombs();
    }

    function rightEdge(index) {
        if (board[parseInt(index) - 5]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        if (board[parseInt(index) - 6]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        if (board[parseInt(index) - 1]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        if (board[parseInt(index) + 4]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        if (board[parseInt(index) + 5]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        displayNumberOfBombsNear(numberOfBombsToDisplay, index);
        remainingBombs--;
        displayRemainingBombs();
    }

    function lowerEdge(index) {
        if (board[parseInt(index) - 6]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        if (board[parseInt(index) - 5]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        if (board[parseInt(index) - 4]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        if (board[parseInt(index) - 1]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        if (board[parseInt(index) + 1]) {
            numberOfBombsToDisplay++;
            howManyBombsNear[]++;
        }
        displayNumberOfBombsNear(numberOfBombsToDisplay, index);
        remainingBombs--;
        displayRemainingBombs();
    }

    function displayAllBombs() {
        for (var i = 0; i < board.length; i++) {
            if (board[i]) {
                document.getElementById(i.toString()).style.backgroundColor = "red";
            }
        }
    }


    function displayNumberOfBombsNear(numberOfBombs, index) {
        var divToChange = document.getElementById(index.toString());
        if (numberOfBombs > 0) {
            divToChange.innerHTML = numberOfBombs;
        }
        else {
            divToChange.style.backgroundColor = "darkGray";
        }
        switch (numberOfBombs) {
            case 5:
                divToChange.style.color = "black";
                break;
            case 4:
                divToChange.style.color = "purple";
                break;
            case 3:
                divToChange.style.color = "red";
                break;
            case 2:
                divToChange.style.color = "green";
                break;
            case 1:
                divToChange.style.color = "#0040ff";
                break;
        }
    }

    function displayRemainingBombs() {
        document.getElementById("remainingBombs").innerHTML = remainingBombs.toString();
    }
</script>
</body>
</html>